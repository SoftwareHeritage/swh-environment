#!/bin/bash

if [ -z "$1" -o ! -d "$1" ] ; then
    echo "Usage: git-add-pre-commit-hook LOCAL_REPO_DIR"
    echo "E.g.:  git-add-pre-commit-hook swh-core"
    exit 1
fi

HOOK=".git/hooks/pre-commit"

cd "$1"

if ! [ -x "$HOOK" ] ; then
    cat > "$HOOK" <<EOF
#!/bin/sh
make check
EOF
    chmod +x "$HOOK"
fi
